// ==UserScript==
// @id             iitc-plugin-CheckBanners
// @name           IITC plugin: Check Banners availability
// @author         TontonPhil
// @category       Layer
// @version        0.0.3.2019.10.20.01
// @namespace      https://github.com/TontonPhil/iitc-plugin-CheckBanners
// @updateURL      https://github.com/TontonPhil/iitc-plugin-CheckBanners/raw/master/CheckBanners.meta.js
// @downloadURL    https://github.com/TontonPhil/iitc-plugin-CheckBanners/raw/master/CheckBanners.js
// @description    search and check if a banner is still present (detect missing portals)
// @include        https://*.ingress.com/intel*
// @include        http://*.ingress.com/intel*
// @match          https://*.ingress.com/intel*
// @match          http://*.ingress.com/intel*
// @grant          none
// ==/UserScript==

function wrapper(plugin_info) {
// ensure plugin framework is there, even if iitc is not yet loaded
if(typeof window.plugin !== 'function') window.plugin = function() {};


// PLUGIN START ////////////////////////////////////////////////////////
// use own namespace for plugin
window.plugin.CheckBanners = function() {};

var notFoundImg = "data:image/png;base64,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";
var questionImg = "data:image/jpeg;base64,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ACiiigApKWkoAKKKWgBKWkooAWiiigAopK+QP21P+CiHhL9mXS7vQ9DaLxL8QJUZIbGGQGGybHDzt7ddgGTjBx1oA9p/aG/ab8B/szeEm1rxlrEVrNKrfYtMjbddXrgfdjjHJHTLH5RkZPIr8Jv2sP2wfGf7VnjWfUNZu5bLw5C5Gm6DE+ILaPsSB95z1LHJycDgADzz4u/GPxZ8cvGd34n8Y6tLquqT8BnOEiXsiL0VR6VxVABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFdR8L/hvrfxd8f6H4P8O2sl5q+rXK28McaltueWc4/hVQzE9gpNcwiNI4VQWYnAA6k1+1n/AASy/Y3b4OeBI/iR4ptEXxb4htw9pbyx/vLC0blckjh3GCcdAcetAH1P+zT+z/oP7Nnwn0rwbocSkxL5t7d7QHurggbpGP4AD2Ar1SkooAKKKKAClpKKACiiigBaSlooASiiigAooooAKWkooAWiiigBKKKWgBKKKKACiiigAooooAKKKKACiiigApaSloASiiloASilpKAClpKWgAopKWgBKWiigBKKWigBKWikoAKKWkoAWkopaACkopaAEopaSgBaKKKACobu7gsLWa5uZo7e2hQySzSsFRFAyWYngAAZJNc38S/if4Z+EHhG98S+LNWg0jSLRCzzSnljj7qr1Zj2Ar8Vf23f+CkHiH9pSW68MeFY7nw18P1cqYHcC51AA8NNtOAOAdgJx6mgD6O/bm/4KprpbX/gf4MX8ct0N0N74qhxIqHoUt8gqT1+fn26Zr8ptS1O71nULi+v7qa9vbhzLNcXDl5JHJyWZjyST3NVqKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKK+0/+CfP7BGq/tH+KrLxb4otfsfw206ffOZW2yai68iKNf7pONzHAxkDJoA9L/4Je/sIRfEm/i+Knj/S3l8M2cn/ABJ9PuAVS9mUgmVh/FGvQdic9cEV+xKqEUKoAUDAA7VU0nSbPQtMtdO0+2js7G1jWGGCFQqRoowFAHQVboAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigBaKSigAooooAKKKKAFpKKKACiij8aACiiigBaSiloASiiigAooooAWkoooAKWkooAWiiigBKWiigAooooASlopKAFpKWigApKWigBKWikoAKWiigBK8S/ak/az8F/sreC5dW8RXaXGsTIf7O0WJ/wB/dvnHA/hUdSx4wD3rzP8AbV/4KE+FP2W7OXQtMEfiPx/NCWi02J/3VpkEK87duedg+Ygc4BBP4dfEz4neJfjB4y1DxT4s1SbVtZvpC8s0rZA9FUfwqOgA4AoA9A/aZ/a08e/tSeK31LxTqTR6VC5+w6LbEpa2qn0XPzN0yzZJ+leLUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUV93fsD/APBOLWPjtqtj408fWculfD2EiWK2lyk2qMOiqOqx+rHGegzkkAHI/sE/sG6n+1Jr417XluNN+H1hOEuLpBte8cYJijJHoRk9s1+6PhTwno/gbw9Y6FoOnwaVpFjGIbe0t1wkagYA9/qeTUnhvw3pfg/QrLRtEsLfS9KsoxFb2lrGI441HYKOB6/jWnQAlFFFABRmiloASiiloASilpKACiiigAopaSgAopaSgAopaKAEopaKAEopaKAEooozQAUUUUALSUUUAFFFFABRS0lAC0lFFABRRS0AJRRRQAUUUUAFFFFABS0UUAFJS0UAFFFJQAtJS0UAFJS0UAJS0UUAJRS0UAJXwv8A8FCP+Chll+z1pVx4L8C3NtqHxEul2TSn95HpUZHLMAeZP7qnp1IOMGl/wUV/4KEwfAW0uPAHgO9Sfx/cRf6XcoNy6XG6nB3dPNwcgduCetfipfX9zql7Pd3lxJdXU7mSWeZyzyMTksxPJJ9aALPiHxDqXizW73WNYvptS1O8lM1xdXDlnkc9SSaz6KKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKkt7eW7njghjaWaRgiIgyWJ6ACtzwJ8P/ABH8TfE1l4e8K6Pda5rN5II4bS0TcxJOMk9FHqzEAdSRX7O/sMf8E1dE+AP2Txj48t7TXvHgUNBC4E1vpreqdjJ23jpzg80AfP37B/8AwS2fxFFp/j/4v281tYFlm0/wzjY84ByHuD1CnsgwSOc81+stlY2+m2cNpaQR2trCojjhhUKiKOAABwBU1LQAlLSUUAFFFFABRRS0AJRRS0AJRRRQAUUUUAFFLSUAFFLSUAFFFLQAlFFFABRS0UAFJS0lABRRS0AFJRRQAUUUUAFFFFAB+NFFFABRRRQAUUUUAFFFBoAKKKKAFoopKAFopKKAFoopKAFopKKAClpKKAFopKKAFr5E/wCCg/7bVr+yz4Ej0rQngvPH+tIyWcDMCLOLHzXDr19lHGSc/wAOD7Z+0f8AHvQf2b/hNrXjTXZVItYmWztM/Nd3JB8uJR7nGT2GTX86PxT+Juv/ABh8eat4t8S30uoatqMxlkklYnaM8Io/hUdABwKAMXxF4h1LxZrt9rOr3kt/qd9M09xczNueR2OSSazqKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoop8EEl1MkMMbyyuQqRopZmJ6AAdTQAyveP2V/2OPHX7Vfij7FoFuNO0O3w19rd2h8iBT0Ax95zg4Ueh54r6h/Yt/4JUav8RPsHi74u2t3oHhxgs1voTHyru7XqPMH3o0PocN9Otfrn4M8EaB8O/DtroXhnR7LQtItVCxWdhCsUa8YzhQMnjknk0AeU/sv/ALIHgT9ljwnBp3h6zF9rTrm9127RTc3LnrjH3F7BR0HUk5J9yoooAKSiigBaSiigBaSiloASiiigApaSigAooooAKWkooAWkpaSgBaSiigApaSigAooooAWiiigBKKWkoAKKWkoAKM0tIaACiiigAooooAWkoooAKKKKACiiigAooooAKWkooAKWkooAKKKKAFpKWkoAKWkpaAEopaSgApk88drBJNK4jijUu7scBQBkmn18Vf8ABVD9pd/gf8DE8N6PeeR4n8XtJaRbCN8VqqjzpPb7yKD/ALR9KAPzl/4KL/td3X7SXxfvNL0md08DeHpmtdOiDcXEi8SXDD/abcB/sha+R6KKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoor6w/Y4/4J8+NP2odRg1W+guvDXgRHHm6xPCUNyB1W3DD5z23DIHegDwn4P/AAR8Z/HfxbbeHfBmiz6rfzOFZ1UiGBT1eR+iqOpNfs7+xn/wTW8Jfs4Rpr/ih7bxh44dVIuJIP8ARrHHOIVbJLZ6ucdsAd/or4Hfs++Bv2d/CMPh7wTokOmW4Uefckb7m6YfxyyHlj+g7ACvRqAADHsKKKKACiiigAooooAKKKKACilpKAClpKKACiiigApaSigAooooAKKWkoAKKO9FABRRRQAtJRRQAtFJn3ooAKKKKACiiigAopaSgAooooAKKKKACiiigAooooAOtFFFABRRRQACiiigAopaSgBaKSloAKSiigBaKSigAopaSgA6V/Pn/wAFEfj1L8ef2ldduoZS2iaITpWnJv3KY0Y7nHoWYk/gK/bH9rX4mP8AB/8AZs+IfiyCTybyx0iZbSTONtxIPKhP4SOlfzb3M73VxLNIcySMXY+pJyaAI6KKKACiiigAooooAKKKKACiiigAooooAKKKKACpbS0nv7mO3toZLi4lYKkUSlmYnoAB1NW/D3h7UvFmuWWj6RZTajqd7KIbe1t0LvI56AAcmv2n/YG/4JyaN8DdKtPGfj6wh1bx/NiW3t5/ni0xcDAC9DJ1JY5xxjBzQB4n+wx/wStluJdP8dfGS1EcAAmsvCzg72JHD3B7Y6hBnnGSOh/VTTdNtdHsLeysbeO0s4EEcUEKhURR0AA6VZpKAFpKWkoAWkopaACkpaSgAooooAKKKKACilooASloooASlopKACilpKACilpKACilpKACiiloAKSiigAopaKACiiigBKKKKACiiigAooooAKKMUUAFFFFABRS0goAKKKKACiiigAooooAKKKKACiiigBaSiloASilpDQAUUtFACUUUUAfn7/wWZ+IC+H/ANnnRPC8Zfztf1aPeF+75cIMnPP94Livxar9OP8Agtz4qWXxp8OvDisS0NhNfOuOBukKL/6Ca/MegAooooAKKKKACiiigAooooAKKKKACiiigAqS2tZr24jt7eJ555WCJFGpZmY9AAOpqOv0X/4JE/srx/EDxnefFbxBZedomgT/AGbTElAKTXgAYtgjnYGUj3NAH1p/wTi/YXh/Z18JxeMPF+n27/ETVIcgMN7abCwB8oHs56MR9MnmvtyiigAooooAWkpaKAEooooAKKWkoAKKKWgBKKKKACiiigApaKSgAooooAKKWkoAKWkooAKKWkoAKKWkoAKKKKACiiloATNFLRQAlFFFABRS0lAC0lFFABRRRQAUUUUAFFLSUAFFFFABRRRQAUUUtACUUUUAFLSUUAFFFFABQaKWgBKKKKAFpKKKAPxW/wCCzl59o/aR0KHP+o0ONfzdm/rXwDX6Hf8ABanRHsfj54R1DyyIr7Qvv44LJKykfgMfnX540AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAdJ8NfAepfE/wAfaB4T0iIzajq95HaRKMcbjy3PYDJ/Cv6SPgb8JNK+Bnwp8OeCdGjVLTSrYRs6rjzZSS0jn3Z2Y/jX5U/8EbfgQ3in4taz8S9Qti+neHLVrWxZl4N3Ngbh67YxKPYuK/ZGgBaSiigBaKSigBaKSigApaSigBaSiigAooooAKKKKAFpKKKACiiigAooooAKKKKAFpKKKAFpKKKAClpKKAFpKWkoAKWkooAWikooAWkoooAWkoooAWkoooAKKKO9ABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAC0lFFABRRRQAUUUUAFFFFABRRRQB+Yv/BbP4f3F54T8A+M4Yi8FlcyabO4I+QOC65HuVIr8kq/oe/4KAfCCT40fsp+ONItI2k1Sytf7VslQZLSW583YPdlVl/4EK/nikjaKRkcFWUkEHsaAEooooAKKKKACiiigAooooAKKKKACgAsQACSeABRX0d+wF8BpPj3+0n4Z02e3abQ9LuE1PUzj5TDEwbY3++Rt/GgD9oP2HvgmPgN+zZ4Q8Oz28cGrS2wvtR2Lgm4lG9gx7lc7fwr3mhVCgAAADoBRQAUUtJQAUtJRQAtFJRQAUUUUAFLSUUAFLSUtABSUUtACUtFJQAtJRRQAUUUUALSUUUAFFFFABRS0lABRRRQAtJRRQAtJRRQAtFJRQAUUUUAFFFFABRRRQAUUUUAFFFFABR1oooAKKKKACiiigAooooAKKKKAFpKWkoAKWkpaAEooooAKKKKAClpKKABlDqVYBlIwQehr+fj/AIKIfs3z/s7/ALQWqR2li1t4V10tqGkyKoEe0n95EMdCjHp6MPWv6B68H/bM/Zg039qj4O3vhyYxWuuWjG70m/dNxhnCkbT32sDg49jzjFAH86FFbfjbwVrPw78U6l4d8QWMunavp8zQT28qkFWHp6g9QaxKACiiigAooooAKKKKACiiigAr9wv+CTH7PI+FfwAXxjqlkIPEXi6RrnMiASR2asVhXPXDbTJ9HFfm9+wB+yXfftPfGK1+2Qyw+DNEZbvVbwJkNg/u4FPTc5H4AMa/f7TtPttJ0+2sbOFbe0tolhhiQYVEUAKB7AAUAWKKKKAClopOlAC0lLSUALSUUUALSUUtABRRRQAlFLSUAFLSUtACUUtJQAtJS0lABS0lFAC0lFLQAUlFFABRS0lAC0naiigBaSlpKACiiigBaKTFFABRRRQAUUUUAFFFGKACijFFABRRRQAUUUUAFFGKKACiiigAooooAKKKKAFpKWkoAKWkooAKKWkoAKKWigApKWigBKKWkoA+Vv23v2E/DP7VXha51Gyt4NI+IdpCfsOrooX7QVHywz4+8p6BjyvHOBivwu+J3wo8WfBvxTc+HfGOh3mharASPKuoiokA/iRujr/tKSK/p6rz740fAPwN+0B4aOh+NtCg1a1UloZWGJrdyMbo36g/pQB/MzRX6a/HD/gi54h0+4ub/wCF3iuz1a0J3JpOtK1vMg/urKu5X+pCV8aePf2L/jZ8Np7iPW/h3rKpDndPaQ/aYyB/EGjLce9AHitFa0/hHXbVis2i6hEw6h7WRSPzFRx+GdYm/wBXpV8/+7bOf6UAZtFdn4a+C/j3xjO0OieDdc1KRcbvIsJSFz0yduBXuvw2/wCCZfx/+I8isPCKeHLQkD7XrtysC/Xau5z/AN80AfK9e+/spfsbeOP2p/FtpbaTp9zYeFkmUah4gliIt4IwfnCMeHkxnCjJz14r9Cv2f/8Agjd4W8I3UWqfE7xB/wAJbdKQy6Vp0RhtVPfe7HdIPbavTvmv0L8K+FNH8EeH7HQ9B0630rSbKIQ29paoESNR2AoA5X4HfAzwl+z34BsvCXg/TlsdPgAaWU8zXMmPmkkbqzH9O2K7+iloASiiigBaSlpKAFpKWkoAWkopaACiikoAWikooAWkoooAKKKKAFopKKAFpKKKAFpKWkoAKKKWgBKWikoAKWikoAKKKWgBKKWkoAKWkooAKKWigBKKKKAFpKWkoAWkpaSgAooooAKKKKACjFFFABRR1ooAKKKKACiiigAooooAKKKWgBKKKWgBKKKKACilpKACloooAKKSloAKSiigAoopaAMq88KaJqDs91o9hcserTWqOT+YqGDwP4ctTmHw/pcJ/wCmdlGv8lraooAitrO3skKW8EcCH+GJAo/SpqKSgBaSiloAKKKSgApaSigBaSiloASilpKAClopKAFpM0tJQAtJRS0AFJS0lABRRRQAUtJS0AJRRRQAtJRRQAUUtFACUUtJQAUUUUALRSUUALSUtJQAtFJS0AFFFFACUUUUAFFFFABQaKKACjNFFABRRiigAooooAKKKKACiiigAooooAKKKKACiiloASiiigAooooAKKWkoAKWkooAKKKKACiiloASiiigAooooAKKKKACiiigBaSiigAooooAKKKKAFpKKKAFopKKACiiigBaSiigBaSiigAooooAKWkooAWiikoAKKKKACiiigAooooAKKKKACiiigAooooAWikooAWikooAKKKKACiiigAopaSgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiloASilpKAClpKWgApKKKACiiigAooooAKKKKACiiloASilpKACiiigAopaSgAooooAKKWkoAKKKKACiiigAoopaAEooooAKKKKACiiigBaSiigAooooAKO1FHagAooooAKKKKACiiigAooooAKKWkoAKKKKACiiigApaKSgAooooAWkooNABRRRQAUdaKKACiiigAooooAKKKKACiiigAooooAKKWigBKKKKACiiigApaSigAooooAKKWigBKKWvM/jR+0l8OP2ftIa/8AHPimy0fIzHZ5Mt1L/uQoC5HvjAyMkUAel0EgdeK/KH42f8FprqaWay+F/hMQRBiq6rrhBZh2KwrkD1+Y18S/Eb9tj42/FIuut/EXXFt3O5rSwu3tYD9Y4yF/SgD+ibVfEuk6EAdR1OzsQRkfaJ1TI/E1gn4yeA1m8o+MdCEv9w6hFn8t1fzI6jql5q9y1xfXU15cN1luJC7H8TVagD+pLSPFei6+SNN1ayvyBki2uFk4/A1qgg+9fyvWd7cafcLPazyW0y/dkicqw+hFeu/Dz9sL4zfC+aNtB+IuvxQpjFpc38k9v/36div6UAf0i0lfkd8Ff+C0mu6YyWnxO8Kx6xCSo/tLRSsUq/3iYjhT2PBHev0V+Bv7V/wu/aJ06O48FeKbW9uyuZNMuMwXkR7gxPgnHquR70AeuUtFFACUtJRQAUUUUAFLRSUAFLSUdqAFpKKKACilooAKSlpKAFpKKKACilooASiiloASiiigBaSiigAooooAWkoooAWkopaACkpaSgBaKSloAKKKKAEooooAKWkooAKO1LSGgAooooAKKOaKAFpKKKACiiigAozRRQAUUUUAFFFFABRS0UAJRRRQAUUtJQAUUUtACUUUUAFNllSCJpJHVI0BZmY4AHqTTbm5is7eWeeVIIIlLySyMFVFAySSeAAO9fjp/wAFF/8AgotffETVr74c/DLWntvCVuxi1DVrCRkbUWxgorjB8oc9OG9xigD2f9tD/grBaeA73UfBvwgW21XWoGMNz4jn/eW1uw+8IU6SMOm4nAIPBr8nfGnjvxB8Rdeuda8S6vda1qlw5eS5u5CzEnrjsPoKwqKACiiigAooooAKKKKACtPw34n1fwdrNrq2h6jc6VqVrIssNzayFHRlOQcj3FZlFAH6r/sYf8FZ5r29sfB3xnMKK+2G18VRfJ83QC5Xpz/fXGO4Ocj9R9M1Sz1rT7e/0+6ivbK4QSQ3EDh0kU9CCOCK/lhr7l/4J+/8FCtU/Z+1ix8F+Nb+fUPh3czBEeZjI2lFm5dOp8vJyVHuQM0AfuFS1T0nV7LXtMttR027hvrC5jEsNzbuHjkQ8hlYcEVboAKKKKAFoopKACiiloAKSiigAooooAKWikoAKKKKACilooASlopKAClpKWgBKKKWgAopKKACiiigBaKSigBaSlpKAFpKKKAFooooASiiigAoooNABRRRQAUd6KKACiiigAooooAKKKKACiiigAooooAKKKKAFoopKACiiigAooooAKWkooAKKK80/aP+NWm/s+/BvxF421J4/wDQICLWGQ48+4YHy4x7k/yNAHwv/wAFXf21n8Lafd/BnwdeGPU7yELr95C2DDC6gi3UjuykbvY4r8iycnJ5NbXjTxhqvxA8W6v4k1y7kvtX1W6ku7qeQ5LO7Fj9BzgDoBgVi0AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAfp/8A8EoP21p9P1i2+C/jG7DWFyrNoF/M+DFKPmNs2eoYZKnsVxzu4/Wmv5Y9G1e80DVrPU9Pne1vrSVZ4ZozhkdTkEfiK/oi/Yk/aFi/aU/Z90DxPLPHJrluDp+rRqRuS5jwCSB03qUf/gdAHvNFFFABRRRQAUUUtACUtJRQAtFJRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAtJRRQAUUUtACUUUUAFFFFABRRS0AFFJiigAooooAKKKKACiiigAooooAKKKKACiiigAooooADRRRQAUZoooAKKPajvQAUUtJQAUUZooAWkoooAKO1FBoAK/I//gtN8bG1Hxd4P+GOn3RNvp1u+q6lGjfK0shCwq3uqpIf+2or9cCwVSTwBySa/m7/AGwfiVJ8Wv2k/HviRrgXMM2ovBbsuNoijxGoGO2FoA8cooooAKKKKACiiigAooooAKKKKACiiigAooooAK/QL/gjx8cD4I+Nmp+A764dNN8UQBrdCfkW7j+7+LKcfgK/P2us+E3j66+FvxL8M+LbJ2S50a/hvU2HBOxgcfQ4oA/p8pKhsruHULOC6t3EsEyLJG69GUjIP5VNigAooooAKWikoAKKKKAFpKKKACiiigAooooAWkoooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAopaKAEoopaAEoopaAEooooAKKKKACiiigAooooAKKKKACiiigAopaSgAo60UUAFFFFABRS0lABRRRQAUUUUAcp8Wdabw38K/GWrrw1hot7dAj1SB2/pX8xuq3JvdUvLg9ZZnk/Nia/pN/ammltv2ZvizLB/rV8KaqQfT/RJcn8q/mo60AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB/Sn+yr4q/4Tb9mz4Za027zbrw9YtLv6+YIVD/8AjwNeqV8+/sAu7/se/C4ycEaPEB9O36V9BUAFFFFAC0lFFABRRxRQAUUUUAFFFFABRRRQAtJRRQAtJRS0AFJRRQAtJRRQAUUUUALSUUUAFFFFABRRRQAtJRS0AJiijNFABRRRQAtJRRQAUUUUAFFFFAB3ooooAKM0UUAFFFFABRRRQAUUUUAHSiiigApaSigApaSigApaSigAooooA4341aS+vfBvx5pkY3SXugX9so9S9vIo/nX8yN/bm0vrmBhhopGQj6Eiv6nZ4UuYZIZFDxyKVZT3BGCK/mi/aO8AP8Lvjr448LtvI07VJkUyfeKk7lz07MKAPOKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiitrwV4Vu/HPi7R/D1gM3uqXcdpCAM/O7BR/OgD+iz9jzw3N4S/Zb+FumXOBcxeHrJpAOzNErEfhnFew1S0PSINA0Ww0y1BFtZwJbxA9lRQo/QVdoAWkoooAKKWigBKWkooAKWkooAWkoooAKKKKAFpKKKACiiigBaKSigBaSiigBaSiigBaKSigApaSigAooooAWikooAWiiigApKKKAClpKKAFpKKKACiiigAoNFFABQKKKADtRRRQAUdaKKACiiigAoopaAEooooAKKKKACiiigAooooAK/Gb/gsv8Gn8KfGjw94+tIW+w+JrFoLhwOFubcqDk/7SSJjP90+lfszXg37bH7PMH7SfwD1zw2qL/bVspvtKmK5KXCKcDtwwJH4j0oA/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";


// used for debug in console
window.plugin.CheckBanners.displayBound = function (bounds) {
    return "North ".concat(bounds.getNorth(),' South ',bounds.getSouth(), ' West ',bounds.getWest(),' East ' ,bounds.getEast())
}

// Center on a portal without zooming (inspired from utils_misc.js / window.zoomToAndShowPortal)
window.plugin.CheckBanners.noZoomAndShowPortal = function(anchorPortal) {

  var latlng = [anchorPortal.portal.latE6/1E6 , anchorPortal.portal.lngE6/1E6];
  var guid = anchorPortal.guid;

  map.setView(latlng, map.getZoom()); // keep current zoom level.
  // if the data is available, render it immediately. Otherwise defer
  // until it becomes available.
  if(window.portals[guid])
    renderPortalDetails(guid);
  else
    urlPortal = guid;
}


// from a waypoint list (extracted from a mission), return the 1st existing portal (skip waypoints and undefined portals)
window.plugin.firstRealPortal = function(waypoints) {
    // loop till the item is a real portal
    // i.e. typeNum == 1 (portal) && portal field exists
    return waypoints.find(function(apoint){
        return apoint.typeNum == 1 && apoint.portal;
    })
}

window.plugin.CheckBanners.removeMissionsLayers = function (searchParameters) {

    searchParameters.markers.forEach(function(marker) {
        searchParameters.missionLayer.removeLayer(marker);
    });
    // empty the list
    searchParameters.markers = []
}

window.plugin.CheckBanners.closeWindow = function() {} ; // will be defined below once searchParameters will be instantiated

window.plugin.CheckBanners.search = function (promptAction, debug_info) {


//  var promptAction = prompt('enter banner text to search for', '');
  if(promptAction !== null && promptAction !== '') {
    // now get the missions than can be seen, and in the call-back we will filter on the search string
    // define the structure that will be used during all the process through call-backs.
    var searchParameters = new Object();
    searchParameters.promptAction = promptAction; // string to search that is common to all missions
    // array of all the missions founds that fit,so far, the searched string
    searchParameters.missionOrder = new Array(0); // declaration now, but dimensionning of the table will be done later
    // following regexp allow to identify structures like "#4 banner" or "4/12 banner" or "banner #4" or "banner 4/12"
    //TODO split the prompt-action to be rid of multiple spaces that could be defined for some missions of the same banner
    searchParameters.searchRegExp = RegExp("([0-9]*)[^0-9]*([0-9]*)[^0-9]*"+promptAction+"[^0-9]*([0-9]*)[^0-9]*([0-9]*)","i");
    searchParameters.initialStateDebugInfo=debug_info; // store debug info, in case to share them later to investigate
    searchParameters.filteredMissionList; // list of all the missions on which we load the details
    searchParameters.moveSpeed = 2500 ; // waiting time between 2 moves (for debug)
    searchParameters.defaultZoom = map.getZoom(); // hypothesis that the user has more or less put the zoom level to be accurrate
    searchParameters.lastSizeOfMissionList ; // used to store last size of mission list, if it is 25 then it was the top 25 missions and me may need to zoom.
    searchParameters.LostMissionRefPortal; // portal used as a reference to search the current missing mission
    searchParameters.LostMissionRefMission ; // mission on which we will move to find the missing mission
    searchParameters.depth ; // nb of attempts to locate current missing mission from portal (on each attempt we change strategy)
    searchParameters.zoomDirection ; // after the 1st unsuccessful attempt, we will either zoom or dezoom... for the next attempts
    searchParameters.algoStep ; // records current step of the algorithm to find the missingMission
    searchParameters.MissingMissionIndex ; // index of the missing mission we are looking for
    searchParameters.LowestMissionIndex ; // lower index of a mission found (used to know if we have to continue searching previous or not).
    searchParameters.MissionsNotFound=[] ; // list of all missions index that we had not found (to avoid looping to search for them)
    searchParameters.searchingPrevious = true ; // we will first search for the beginning of the banner (from the missions found)
    searchParameters.computeZoomDirection = true ; // set to true at each move of the screen, in order to recompute if zoom or dezoom have to be applied
    searchParameters.starting = true ; // used to identify the case were we cannot find any mission on the 1st search
//    console.log(window.plugin.CheckBanners.displayBound(window.map.getBounds()));
// create the function trigged to clean the drawn layers when closing the window.
    $(window.DIALOGS['dialog-plugin_searchBanner']).data('closeCallback' ,window.plugin.CheckBanners.removeMissionsLayers.bind(this,searchParameters));

// we create a new searchParameters object on each search. but we loose then the previous displayed layer (if displayed)
// keep a global var that point to the previous searchParameter (in order to clean)
    if (! (window.plugin.CheckBanners.PrevSearch === undefined)) {
    // there was a previous search,
    // clean the previous mission layer if displayed on the screen
        if ( window.plugin.CheckBanners.PrevSearch.markers) {
            // a layer way already displayed, => clean it
            window.plugin.CheckBanners.removeMissionsLayers( window.plugin.CheckBanners.PrevSearch);
        }
    }
    // so save current searchParameter to the history
    window.plugin.CheckBanners.PrevSearch = searchParameters;

    searchParameters.missionLayer = new L.LayerGroup() ; // layer to display the full mission drawing
    window.addLayerGroup('Banner Path',searchParameters.missionLayer,true) ;
    searchParameters.markers = [] ; // list of all the markers into the mission Layer (used for cleaning the screen).

    // clean the previous results (if there have been)
    document.getElementById('banner_images').innerHTML ="";
    document.getElementById('detected_errors').innerHTML = '' ;
    document.getElementById("DrawBannerPath").disabled = true;

    // for debugging (when button is pressed, it will allow the trig a breakpoint in the main loop
    var debugButton = document.getElementById("CheckBanners_StopButton");
    if (debugButton) {
        // define the on-click action of the button
        debugButton.onclick = function() {searchParameters.debugButtonPressed=true}
    }


    window.plugin.missions.loadMissionsInBounds(window.map.getBounds(),window.plugin.CheckBanners.callBackMissionLoaded.bind(window.plugin.missions,searchParameters))
  } else {console.warn('CheckBanner nothing to search') }
}

// add new empty rows into the banner
// nbRow => will add x row of of 6 missions
// firstMissionId = number of the 1st mission added on the bottom right (so either 1 or 7 or 13 or ...)
window.plugin.CheckBanners.addMissionSetInBanner=function(nbRow,firstMissionId) {

    var bannerImageTable = document.getElementById('banner_images');
    var firstNode = bannerImageTable.firstChild;
    var rowElt ; // html code for elements of the table to insert
    var element; // <td>
    var img; // <div> to at least define the CSS class and the default size
    var infoContainer ; // <div> used to display the tooltip
    var bubble; // <span> the tooltip itself
    // create one or more row of 6 columns (we insert element to respect
    for (var row = 0; row < nbRow; row++) {
        rowElt = document.createElement('tr');
        bannerImageTable.insertBefore(rowElt,bannerImageTable.firstChild);
        for (var col= 0 ; col <  6;col++ ) {
            // insert an empty entry in thetable, with a specific identifier
            missionNb = (firstMissionId + row*6 + col);
            element = document.createElement('td');
            element.id = 'banner_mission_id' +  missionNb;
            // no image yet, but the class
            // we insert 2 diff div class - the upper one to contain the span info (infobubble)
            // the lower one to contained the rounded image
            infoContainer = document.createElement('div');
            infoContainer.className = 'roundedImageBubble';
            element.appendChild(infoContainer);
            bubble=document.createElement('span');
            bubble.id='banner_mission_bubble_id' + missionNb ;
            bubble.className="roundedImageBubbleText";
            bubble.innerHTML="--searching mission " + missionNb +"--";
            infoContainer.appendChild(bubble);
            imgContainer = document.createElement('div');
            imgContainer.className = 'roundedImage';
            imgContainer.id='banner_image_div_id' + missionNb ;
            infoContainer.appendChild(imgContainer);
            var img=imgContainer.appendChild(document.createElement('img'));
            img.src = questionImg;

            rowElt.insertBefore(element,rowElt.firstChild);
        }
    }
}

// display the mission image in the banner
// mission = data structure of the mission
// missionId = number of the mission
window.plugin.CheckBanners.updateMissionInBanner = function(mission,missionId) {

    var bannerImageDiv = document.getElementById('banner_image_div_id'+missionId);
    var bubbleSpan = document.getElementById('banner_mission_bubble_id'+missionId);

    // if image has already been created then skip
    if (! bannerImageDiv.hasAttribute("loaded")) {

        // replace default image by mission image
        var img=bannerImageDiv.firstChild; // we considere there is only the image inside the <div>
        var children = bannerImageDiv.childNodes; // just to check with debugger TODO to remove

        img.src = mission.image;
        bubbleSpan.innerHTML = mission.title;
        // add event listener on click to display the mission
        img.addEventListener('click', function(ev) {
            console.log('view mission '+missionId);
            window.plugin.missions.showMissionDialog.bind(window.plugin.missions)(mission);
        });
        bannerImageDiv.setAttribute("loaded",true);
        console.log('mission ' + missionId +' inserted');
    }
}

// TODO function not used - may not be the proper way to optimize
// attempt to optimise performances (as it seems that the mission cache is not really performant)
// (use the DOM state instead of mission cache, in order to know if a mission is loaded or not)
window.plugin.CheckBanners.isMissionfullyLoaded = function(missionId) {
    var bannerImageDiv = document.getElementById('banner_image_div_id'+missionId);
    return ( bannerImageDiv.hasAttribute("loaded")) ;
}

// we didn't found the mission, put a cross, it is considered as definitive loss
window.plugin.CheckBanners.MissionInBannerNotfound = function(missionId) {
     var bannerImageDiv = document.getElementById('banner_image_div_id'+missionId);
     var bubbleSpan = document.getElementById('banner_mission_bubble_id'+missionId);
         // replace default image by the cross
     var img=bannerImageDiv.firstChild; // we considere there is only the image inside the <div>
     img.src=notFoundImg;
     bubbleSpan.innerHTML = "mission" +missionId + " not found"

}

// display error window if we didn't find any mission for this banner (and leave researching)
window.plugin.CheckBanners.ErrorNoMissionfound = function (searchParameters) {
    // we didn't find any mission, warn user to position on a known mission of the banner
    var html =  '<p><font color="red"><b>Cannot find any banner mission containing '+
                searchParameters.promptAction +
                ' in range </b></font></p>' +
                '<p>Please try to position the intel on a place where a one of the mission of the banner can be seen (best is the last one, but ant mission of the banner can fit</p>'
    dialog({
        html: html,
        id: 'plugin_searchBanner_error',
        title: "search Banner-Can't find mission",
        width: 'auto'
    });
    throw "no mission found";
}

// call back, on the return of the LoadMissionInBound (i.e. load the top missions that can be seen)
window.plugin.CheckBanners.callBackMissionLoaded = function (searchParameters,missions) {

    var missionOrder = searchParameters.missionOrder;
    var missionOrderDimenssionned = (missionOrder.length != 0);
    var missionListToLoad =[]; // list of tuple (mission, missionIndex from 0)

    searchParameters.lastSizeOfMissionList = missions.length;
    console.log(missions.length +" missions in bounds")
    // create the regExp to search without taking in account Maj/min
    var expr = new RegExp(searchParameters.promptAction,'i');

    var regexpResult=missions.map((mission) => [searchParameters.searchRegExp.exec(mission.title),mission]);
    // keep only the missions that contains the string into their title
    var filteredMissionsTuple = regexpResult.filter((missionTuple) => missionTuple[0] != null );


    // check that we find at least a mission if it is the 1st search
    if (searchParameters.starting) {
        searchParameters.starting =false;
        if (filteredMissionsTuple.length == 0) {
            // no mission containing the name has been found - leave
            window.plugin.CheckBanners.ErrorNoMissionfound(searchParameters);
        }
    }

    // sort missions and check if missings
    // depending on the way the missiong position had been defined by the author (as #x or x/y or whatever), we don't use the regexp result the same way.
    filteredMissionsTuple.forEach(function(missionTuple) {
        var mission = missionTuple[1];
        var regExResult = missionTuple[0];
        var totalMissionCount; // nb of missions into the banner (may not be provided)
        var missionPos; // position on the mission in the banner

        // find the numbering scheme in the banner
        // regExResult[0], is the matching string result, we don't really care...
        // look if it is at the begining of the banner (i.e. before the string identifying the banner
        if ((regExResult[1] !='' ) && (regExResult[2] != '')) {
                // we have position and number of missions included into the banner
                // we suppose the scheme is that mission position is before total number of mission (like 4/ 12)
           totalMissionCount = regExResult[2];
           missionPos = regExResult[1];
        } else {
             // only missionPos is defined (but it may be defined at the end of the banner so the result may still be undefined
           missionPos = (regExResult[1] != '' ? regExResult[1] : regExResult[2]);
        }
        // if we didn't find mission number at the begining, then check at the end
        if (missionPos == '') {
            if ((regExResult[3] != '' ) && (regExResult[4] != '')) {
                totalMissionCount = regExResult[4];
                missionPos = regExResult[3];
            } else {
                missionPos = (regExResult[3] !== '' ? regExResult[3] : regExResult[4]);
            }
        }

        // convert to Number
        missionPos = ((missionPos !== undefined && missionPos !='' ) ? Number(missionPos) : undefined);
        totalMissionCount = ((totalMissionCount !== undefined) ? Number(totalMissionCount) : undefined);

        // check if the size of the banner must be adapted
        var currentLength = missionOrder.length;
        if ((totalMissionCount !== undefined) && (currentLength == 0)) {
            // we must dimension the total number of entries into the banner
            if (totalMissionCount < missionPos) {
                // adjust to missionPos
                totalMissionCount = Math.ceil(missionPos/6)*6;
            }
            missionOrder.length = totalMissionCount;
            var nbRow=Math.ceil(totalMissionCount/6);
            window.plugin.CheckBanners.addMissionSetInBanner(nbRow,1);
        } else {

            if (missionPos > currentLength) {
                // we find a mission which is outside to the current size, and the total number of mission of the banner is unknown
                // then we increase the size by a modulo 6
                var newExpectedTotalMission = Math.ceil(missionPos/6)*6;
                missionOrder.length = newExpectedTotalMission;
                console.log('resizing banner to ' + newExpectedTotalMission + ' missions')
                // update the display window size for the mission icons
                var nbRow=Math.ceil((newExpectedTotalMission-currentLength)/6);
                window.plugin.CheckBanners.addMissionSetInBanner(nbRow,currentLength+1);
            }

        }

        if (missionPos !== undefined) {
            // to avoid to include mission containing the same sentence, but not part of any banner
            var missionIndex = missionPos-1
            missionOrder[missionIndex] = mission;
            // TODO check if LowestMissionIndex is really used
            if (searchParameters.LowestMissionIndex !== undefined && missionPos-1 < searchParameters.LowestMissionIndex) {
                searchParameters.LowestMissionIndex = missionPos-1;
            }
            // add this Tuple to the list of mission details to load
            missionListToLoad.push([mission , missionIndex]);
        }

//    console.log("mission " + missionPos )
    } )

    // from the identified mission, load the complete mission info in order to check if all portals are still existing
    searchParameters.filteredMissionList = missionListToLoad;

    var missiontupleToLoad = searchParameters.filteredMissionList.pop();
    // check if at least a mission has been found
    if (missiontupleToLoad === undefined) {
        // no mission fitting the search has been found
        if (missionOrderDimenssionned == false) {
            // it is our 1st search and we didn't find any missing fitting in fact => give-up with dialog message
            window.plugin.CheckBanners.ErrorNoMissionfound(searchParameters);
        } else {
            // we didn't find any mission this time, go to the next step of the searching algo
            // TODO remove this crapy workaround and refine the callBackMissionDetailLoaded to extract the algorithm
            missionIndex = window.plugin.CheckBanners.nextExistingMission(0,missionOrder);
            window.plugin.CheckBanners.callBackMissionDetailLoaded(searchParameters,missionIndex,missionOrder[missionIndex]);
        }
    } else {
        window.plugin.missions.loadMission.bind(window.plugin.missions)(
            missiontupleToLoad[0].guid,
            window.plugin.CheckBanners.callBackMissionDetailLoaded.bind(this,searchParameters,missiontupleToLoad[1]));
        // aysnchronous procedure is now continued in callBackMissionDetailLoaded
    }
}

// usefull only if all missions in the sequence have not been identified
window.plugin.CheckBanners.nextExistingMission = function (index,missionArray) {
    if (index >= missionArray.length)  throw "end";
    var newIndex = missionArray.slice(index).findIndex((element)=> element !== undefined)
    if (newIndex >= 0) {
        return index + newIndex ;
    } else {
    throw "end";
    }

}

// call back once a mission is loaded , then load the following one (to avoid to load all missions at the same time)
// once all missions loaded, then perform the analysis on potential missing elements
window.plugin.CheckBanners.callBackMissionDetailLoaded = function (searchParameters, currentIndex ,mission) {
    // complete mission info loaded, so override the summary mission
    var missionOrder=searchParameters.missionOrder;
    var GoAndPerformFinalAnalysis = false;
    var missiontupleToLoad;

    missionOrder[currentIndex] = mission;
//    console.log("mission " + (currentIndex+1) + " fully loaded")

    // update the image of the mission into the banner
    window.plugin.CheckBanners.updateMissionInBanner(mission,currentIndex+1);

    // check if missions remain to be loaded
    missiontupleToLoad = searchParameters.filteredMissionList.pop();

    if (missiontupleToLoad !== undefined) {
        // a mission remains to load, => go loop
        window.plugin.missions.loadMission.bind(window.plugin.missions)(
                missiontupleToLoad[0].guid,
                window.plugin.CheckBanners.callBackMissionDetailLoaded.bind(this,searchParameters,missiontupleToLoad[1]));
    } else {
        // all the complete missions have been downloaded
        // analysis if missing entries, and try to locate them on the map

        // if a stop has been requested for debuging (a breakpoint have to be set in the inside code)
        if(searchParameters.debugButtonPressed) {
            // put the breakpoint here
            searchParameters.debugButtonPressed = false;
            debugger; // will stop if the console is opened
            if (searchParameters.debugButtonPressed =="exit") {throw "exiting"} // to cancel all the search now (can only be set through debugger)
        }

        // index of first missing mission
        var indexMissing = missionOrder.findIndex((entry) => entry === undefined );

        if (indexMissing != -1) {   // there are still missing missions

            var continueSearch = true; // by default we will continue to search and zoom
            if (searchParameters.computeZoomDirection == true) {
                // screen had been moved in previous step, so recompute which zoom algo should be applied
                searchParameters.computeZoomDirection = false ;
                if (searchParameters.lastSizeOfMissionList >= 25) { //25 is the max number of missions provided by the intel API
                      // the intel gave us the maximum size of missions list, so the mission may not be into the top, we have to zoom in
                      searchParameters.zoomDirection = +1 ;
                } else {
                      // from this position we had all the available missions with this zoom level, so zoom out
                      searchParameters.zoomDirection = -1 ;
                }
            }

            // are we currently searching for a mission ?
            if (searchParameters.MissingMissionIndex === undefined ) {
                // we were not searching for any mission so far.
                // define which mission we should look for (we will start from the last known one). we know that there is a missing mission.
                var index = missionOrder.slice().reverse().findIndex((entry) => entry !== undefined )  ;
                    // index is the mission on which we could anchor (as it is the 1st step of the algo, we didn't looked for a mission so far)
                window.plugin.CheckBanners.DefineMissionToSearch(searchParameters, missionOrder.length -1 -index);
                // whatever the mission is, we are at the 1st step, that is the zooming (or dezoom) one, on the intial screen
                searchParameters.algoStep = "1-zoom";

            } else {
                // we were searching for a mission, so based on the current situation,

                // check if the mission we were looking for is found
                if (missionOrder[searchParameters.MissingMissionIndex] !== undefined) {
                    // mission found, so define which is the new mission to search for (from our current position)
                    if (window.plugin.CheckBanners.DefineMissionToSearch(searchParameters,searchParameters.MissingMissionIndex)==true) {
                        // position on the reference portal
                        console.log("portal " +searchParameters.LostMissionRefPortal.title);
                        // focus the search
                        map.setZoom(searchParameters.defaultZoom);
                        searchParameters.zoomDirection =0 ; // don't define yet the direction, wait for next step
                        // 1st attempt : center on portal and load all missions around to see if new missions are detected
                        window.plugin.CheckBanners.noZoomAndShowPortal(searchParameters.LostMissionRefPortal);
                        searchParameters.computeZoomDirection=true; // next time recheck the zoom direction
                        searchParameters.algoStep = "focusPortal"; // define the next step of the algo
                    } else {
                        // no more missions to find => position flag to exit searching
                        GoAndPerformFinalAnalysis = true;
                    }
                } else {
                    // continue to search for this mission
                    // check if continuing of zooming is usefull or not
                    if ((searchParameters.zoomDirection > 0 && searchParameters.lastSizeOfMissionList < 25)
                         ||
                        ( searchParameters.zoomDirection < 0 && searchParameters.lastSizeOfMissionList >= 25 )
                         || map.getZoom() < 8 ) {  // zoom = 3 is the world, we won't find the mission - so stop at zoom level=8
                        // by zooming/unzomming more, we wont find more missions
                        // define the next step/substep of the search algo

                        // TODO vérifier que l'on n'aurait pas trouvé la mission cherchée entre temps, dans ce cas il faut repasser sur l'algo initial
                        switch (searchParameters.algoStep) {
                            case "1-zoom" : // we were zooming not focused on any portal or position
                            // so focus the screen position on the last/first existing portal

                                console.log("zoom to portal " +searchParameters.LostMissionRefPortal.title);
                                // focus the search
                                map.setZoom(searchParameters.defaultZoom);
                                // 1st attempt : center on portal and load all missions around to see if new missions are detected
                                window.plugin.CheckBanners.noZoomAndShowPortal(searchParameters.LostMissionRefPortal);
                                console.log("focus on Lat :" + searchParameters.LostMissionRefPortal.portal.latE6 + " Lng :" + searchParameters.LostMissionRefPortal.portal.lngE6);
                                searchParameters.computeZoomDirection=true; // next time recheck the zoom direction
                                searchParameters.algoStep = "focusPortal"; // define the next step of the algo
                                break;

                            case "focusPortal": // we were focusing on a portal, but didn't find the searched mission
                                // we will then move the screen to focus farther (at the distance between 1st and last portal of current known mission
                                var anchorPortal = searchParameters.LostMissionRefPortal ;
                                var oppositePortal = searchParameters.LostMissionRefOppositePortal;
                                // we shift the screen by the distance between the 2 portals
                                var latlng = [2*anchorPortal.portal.latE6/1E6 - oppositePortal.portal.latE6/1E6
                                 , 2*anchorPortal.portal.lngE6/1E6 - oppositePortal.portal.lngE6/1E6 ];

                                //map.setZoom(searchParameters.defaultZoom);
                                map.setView(latlng, map.getZoom()); // keep current zoom level and move the map.
                                console.log("focus on Lat : " + latlng[0] + " Lng :" + latlng[1]);
                                searchParameters.computeZoomDirection=true; // next time recheck the zoom direction
                                searchParameters.algoStep = "movedDirection"; // define the next step of the algo
                                break;
                            case "movedDirection": // try now to move by twice the distance between the 2 portals of the previous missions
                                var anchorPortal = searchParameters.LostMissionRefPortal ;
                                var oppositePortal = searchParameters.LostMissionRefOppositePortal;
                                // we shift the screen by the distance between the 2 portals
                                var latlng = [3*anchorPortal.portal.latE6/1E6 - 2*oppositePortal.portal.latE6/1E6
                                 , 3*anchorPortal.portal.lngE6/1E6 - 2*oppositePortal.portal.lngE6/1E6 ];

                                //map.setZoom(searchParameters.defaultZoom);
                                map.setView(latlng, map.getZoom()); // keep current zoom level and move the map.
                                console.log("focus on twice - Lat : " + latlng[0] + " Lng :" + latlng[1]);
                                searchParameters.computeZoomDirection=true; // next time recheck the zoom direction
                                searchParameters.algoStep = "movedDirectionTwice"; // define the next step of the algo
                                break;

                            case "movedDirectionTwice":
                                // TODO, define  new step by searching by +90° and then -90°
                                // give up and search for another mission
                                if (window.plugin.CheckBanners.DefineMissionToSearch(searchParameters,searchParameters.MissingMissionIndex)==true) {
                                    // there is a new mission to search for
                                    console.log("portal " +searchParameters.LostMissionRefPortal.title);
                                    // focus the search
                                    map.setZoom(searchParameters.defaultZoom);
                                    searchParameters.zoomDirection =0 ; // don't define yet the direction, wait for next step

                                    // 1st attempt : center on portal and load all missions around to see if new missions are detected
                                    window.plugin.CheckBanners.noZoomAndShowPortal(searchParameters.LostMissionRefPortal);
                                    console.log("focus on Lat :" + searchParameters.LostMissionRefPortal.portal.latE6 + " Lng :" + searchParameters.LostMissionRefPortal.portal.lngE6);
                                    searchParameters.computeZoomDirection=true; // next time recheck the zoom direction
                                    searchParameters.algoStep = "focusPortal"; // define the next step of the algo

                                } else {
                                    // we didn't find any mission to search for. so give-up searching and perform analysis
                                    GoAndPerformFinalAnalysis = true;
                                }
                                break;
                            default :
                                // we're lost , it is an unknown algo - give up....
                                throw "unkown banner search algo - give up";
                            }

                    }
                }
            }
            if (GoAndPerformFinalAnalysis == false) {
            // continue the zooming algorithm -but we may have changed the reference
            searchParameters.depth += 1;
            map.setZoom( map.getZoom() + searchParameters.zoomDirection );

            window.plugin.CheckBanners.showProgress(searchParameters);
            console.log('Zoom Level ' + map.getZoom() );
            console.log('search depth ' + searchParameters.depth);
            if (searchParameters.MissingMissionIndex !== undefined) {console.log('missing mission: ' + (searchParameters.MissingMissionIndex + 1));}
            console.log('algo ' + searchParameters.algoStep);
            console.log('direction '+ (searchParameters.searchingPrevious ? "previous" : "following"  ));

            // set a timeout to avoid to chain requests (to avoid ban...)
            setTimeout(
                window.plugin.missions.loadMissionsInBounds(window.map.getBounds(),
                                                            window.plugin.CheckBanners.callBackMissionLoaded.bind(
                                                                window.plugin.missions,searchParameters)),
                searchParameters.moveSpeed);
            }
        } else {GoAndPerformFinalAnalysis = true;}

        if (GoAndPerformFinalAnalysis == true) {
            console.log("all possible loaded");
            window.plugin.CheckBanners.PerformFinalCheck(searchParameters);
        }
    }
}


// define which mission we should look for now.
// ReferenceMissionIndex, is the index of the mission around which we should search (index starting at 0 for mission #1)
// the referenceMissionIndex is the previous mission we were searhcing for (whatever we find it or not).
// returns true => there are still thing to search
//         false => nothing to search more.
window.plugin.CheckBanners.DefineMissionToSearch = function (searchParameters, referenceMissionIndex) {

    var missionOrder = searchParameters.missionOrder;
    var newIndex;
    var newMissingIndex;

    if (searchParameters.searchingPrevious == true) {
        // we are searching backward (form mission #x to mission #1)
        // check if an known mission and then an unknown mission remains between beginning of the table and current reference.

        newIndex = missionOrder.slice(0,referenceMissionIndex+1).reverse().findIndex((element)=> element !== undefined);
        if (newIndex >=0) {
            // we find the upper existing mission on which we could anchor, now check if there are lower missing missions
            newMissingIndex = missionOrder.slice(0,referenceMissionIndex +1 -newIndex).reverse().findIndex((element)=> element === undefined);
            if (newMissingIndex >=0) {
                // there is a missing mission and a mission on which we could anchor to find the missing ones.
                var newExistingRefIndex = referenceMissionIndex -newIndex - newMissingIndex +1;
                // searching previous mission so, so closest portal is the 1st one
                console.log("position on known mission : " +(newExistingRefIndex+1));
                searchParameters.LostMissionRefMission=missionOrder[newExistingRefIndex];
                searchParameters.MissingMissionIndex = newExistingRefIndex-1;
                searchParameters.computeZoomDirection=true;
                var firstKnownMissionWps = searchParameters.LostMissionRefMission.waypoints;
                searchParameters.LostMissionRefPortal = window.plugin.firstRealPortal(firstKnownMissionWps);
                searchParameters.LostMissionRefOppositePortal = window.plugin.firstRealPortal(firstKnownMissionWps.slice().reverse());
                searchParameters.depth = 0;
            } else {
                // all the missions before the reference one are known, so move forward now (and start from the 1st mission)
                searchParameters.searchingPrevious = false;
                referenceMissionIndex = 0;
            }
        } else {
            // there are missing mission before, but we don't have any known mission on which we could anchor,
            // so stop searching back, and move forward from this mission
            searchParameters.searchingPrevious = false;
        }

    }
    // we are searching forward (from #1 to #x), is there any missing mission from the reference one(excluded) till the end.
    if (searchParameters.searchingPrevious == false) {
        // search if there is a possible reference from the current position
        newIndex = missionOrder.slice(referenceMissionIndex).findIndex((element)=> element !== undefined);
        if (newIndex >=0) {
            // check if there are mission to find
            newMissingIndex = missionOrder.slice(referenceMissionIndex+newIndex).findIndex((element)=> element === undefined);
            if (newMissingIndex >= 0) {
                // there is a hole
                var newExistingRefIndex = referenceMissionIndex + newIndex + newMissingIndex -1;
                console.log("position on know mission : " + (searchParameters.MissingMissionIndex + 1));
                searchParameters.LostMissionRefMission=missionOrder[newExistingRefIndex];
                searchParameters.MissingMissionIndex = newExistingRefIndex +1;
                searchParameters.computeZoomDirection=true;
                // position on the last portal of the previous mission
                var PrevMissionWps = searchParameters.LostMissionRefMission.waypoints;
                // we reverse the table and then search for the 1st portal - in order to find the last portal
                searchParameters.LostMissionRefPortal = window.plugin.firstRealPortal(PrevMissionWps.slice().reverse());
                searchParameters.LostMissionRefOppositePortal = window.plugin.firstRealPortal(PrevMissionWps);
                searchParameters.depth =0;
            } else {
                // there is no missing missions from this position, so stop
                return false;
            }
        } else {
            // no more reference to use for new misson to search - return false
            return false;
        }
    }
    // there is still a mission to search for
    return true;
}

// once all each individual mission has been fully downloaded, check each portal to ensure that there are not undefined portal
window.plugin.CheckBanners.PerformFinalCheck = function (searchParameters) {

    var missingMission = false;
    var missionOrder = searchParameters.missionOrder;
    var missionsNotFoundHTML='';

    // TODO check if it is usefull to display the mission list
//     window.plugin.missions.showMissionListDialog(missionOrder.filter((mission)=> mission !== undefined));

    document.getElementById('detected_errors').innerHTML = '' ;

    var errorMissions = new Array(0);
    var missionItems = missionOrder.entries(); // iterator [mission n° , mission]
    for (let missionSeq of missionItems) {
        try {
            var waypointsItems = missionSeq[1].waypoints.entries(); // iterator [waypoint id in the mission, waypoint]
            for (let waypointSeq of waypointsItems) {
                // typeNum == 1 mean deleted item.
                // console.log(waypointSeq[1])
                // if the type is portal (typenum==1), but not portal info then it is a deleted one
                if (waypointSeq[1].typeNum == 1 && ! waypointSeq[1].portal) {
                    var issueWaypoint = {
                        missionNum: missionSeq[0] +1,
                        mission:   missionSeq[1],
                        portalNbInMission: waypointSeq[0] +1,
                        portal: waypointSeq[1]
                    }
                    errorMissions.push(issueWaypoint);
                    console.log("error in " + issueWaypoint.mission.title + " on portal nb " + issueWaypoint.portalNbInMission);
                }
            }
        }
        catch {
            console.log("mission n°" + (missionSeq[0]+1) + " not found");
            // put the not found icon
            missionsNotFoundHTML += 'mission n°' + (missionSeq[0]+1) + ' not found <br />'
            window.plugin.CheckBanners.MissionInBannerNotfound(missionSeq[0]+1);
            missingMission = true;
        }
    }
    if (errorMissions.length > 0) {

        errorMissions.forEach(function(problem) {
            var oneIssue = "mission n°" + problem.missionNum + ", portal n°" + problem.portalNbInMission + " lost" ;
            console.log(oneIssue ) ;
            // insert text error, and bind to the mission window id user wants to see more
            var spanId = 'spanError' + problem.missionNum + 'p' + problem.portalNbInMission;

            //document.getElementById('detected_errors').innerHTML += ( '<span id = "'+ spanId +'">' + oneIssue +' </span> <br />') ;
            document.getElementById('detected_errors').innerHTML += ( '<a id = "'+ spanId +'" onclick=window.plugin.CheckBanners.popMissionDialog("'+ problem.mission.guid + '") >' + oneIssue +' </a> <br />');
            var linkMission = document.getElementById(spanId);
 //           linkMission.onclick = function() {
 //                   console.log("on-click")
 //                   window.plugin.missions.showMissionDialog.bind(window.plugin.missions)(problem.mission);
//            window.plugin.missions.showMissionDialog.bind(window.plugin.missions)(problem.mission);
//                }
            var tooltip = document.getElementById('banner_mission_bubble_id'+problem.missionNum);
            tooltip.innerHTML += "\n issue on portal " + problem.portalNbInMission;
            // override mission image to show mission has an issue
//            var bannerImageDiv = document.getElementById('banner_image_div_id'+problem.missionNum);
//            var imgOverride=bannerImageDiv.appendChild(document.createElement('img'));
//            imgOverride.className='BannerOverlay';
//            imgOverride.src = notFoundImg;
            // put the link to the mission (as this image is overriding the previous one)
//            imgOverride.addEventListener('click', function(ev) {
//                console.log('view mission '+problem.missionNum);
//                window.plugin.missions.showMissionDialog.bind(window.plugin.missions)(problem.mission);
//            });
        })
    } else if (missingMission == false) {
        document.getElementById('detected_errors').innerHTML = ( 'none') ;
    }

    // indicate also the mission that the algorithm didn't detected
    document.getElementById('detected_errors').innerHTML += missionsNotFoundHTML;

    // activate then the button allowing to display the full path of the banner
    var drawButton = document.getElementById("DrawBannerPath");
    drawButton.disabled = false;
    drawButton.onclick = window.plugin.CheckBanners.drawMissions.bind(this,searchParameters);

}


window.plugin.CheckBanners.popMissionDialog = function(guid) {
     mission = window.plugin.missions.getMissionCache.bind(window.plugin.missions)(guid,false);
     window.plugin.missions.showMissionDialog.bind(window.plugin.missions)(mission);
}

window.plugin.CheckBanners.drawMissions = function(searchParameters) {
    var missionOrder = searchParameters.missionOrder;
    var markers = [];
	var latlngs = [];

    if (searchParameters.markers) {
        // clean the previous display as we will remove it
        window.plugin.CheckBanners.removeMissionsLayers(searchParameters);
    }

    missionOrder.forEach(function(mission) {
        var firstPortal = true;
        console.log('path for mission ' + mission.title)
        // link all waypoints, but only circle the start of each mission
		mission.waypoints.forEach(function(waypoint) {
			if (!waypoint.portal) {
			// TODO take in account also 'field trip' in order to display them also on the map - but the mission plugin does not seem to decode fully the field trip elements
				return;
			}

			var ll = [waypoint.portal.latE6 / 1E6, waypoint.portal.lngE6 / 1E6];
			latlngs.push(ll);

            if (firstPortal ) { // only put a circle on the First portal of each mission
//    			var radius = window.portals[waypoint.portal.guid] ? window.portals[waypoint.portal.guid].options.radius * 1.75 : 5;
                var radius = 15
//                console.log ('radius ' + radius + ' ' + portal.title);
                var marker = L.circleMarker(ll, {
                        radius: radius,
                        weight: 3,
                        opacity: 1,
                        color: window.plugin.missions.MISSION_COLOR,
                        fill: false,
                        dashArray: null,
                        clickable: false
                    }
                );
                searchParameters.missionLayer.addLayer(marker);
                markers.push(marker);
                firstPortal = false
			}
		})
	})

    var line = L.geodesicPolyline(latlngs, {
        color: window.plugin.missions.MISSION_COLOR,
        opacity: 1,
        weight: 4,
        clickable: false,
        dashArray: '1,5'
    });
    searchParameters.missionLayer.addLayer(line);
    markers.push(line);

    // highlight layers
    searchParameters.missionLayer.eachLayer(function(layer) {
        layer.bringToFront();
    });

    map.fitBounds(L.latLngBounds(latlngs),{maxZoom: 17});
    searchParameters.markers = markers;

}


// TODO show the progres on the interface (as when there are more than 36 mission we don't know were we are in the progress)
window.plugin.CheckBanners.showProgress = function (searchParameters) {

    var progressMissionInfo = document.getElementById('CheckBanners_ProgressText');
    if (searchParameters.MissingMissionIndex !== undefined) {
        progressMissionInfo.innerHTML = (searchParameters.MissingMissionIndex + 1);
    } else {
        progressMissionInfo.innerHTML = "starting";
    }

}


window.plugin.CheckBanners.questionwindow = function () {

	var html ='';


    // text to search
    html +=
        '<table>' +
			'<tr>' +
				'<td>' +
				    'string to search' +
				'</td>' +
				'<td>' +
    				'<input id="CheckBanners_SearchString" size="25" type="text" >' +
				'</td>' +
            '</tr>'
         +'</table>';

    // add Search button
    html +=
            '<div style="text-align:center">' +
                '<button id ="CheckBanners_SearchButton" type="button" onclick="window.plugin.CheckBanners.questionwindowGo()">Search</button> ' +
//                '<button id ="CheckBanners_DebugButton" type="button" onclick="window.plugin.CheckBanners.questionwindowGoDebug()">Search Debug</button> '+
//                '<button id ="CheckBanners_StopButton" type="button">Stop to Debug</button> '+
            '</div>';

    // progress pane to show current mission we are looking for
    html += '<div style="text-align:center">' +
            "searching mission " +
            '<span id="CheckBanners_ProgressText">' +
            '</span>' +
            '</div>';
    // debug pane, in order to reproduce issue
    html += '<table id="CheckBanners_DebugTable">'+
                '<tr> <th>Debug Info</th> </tr>' +
/*                '<tr>'+
                    '<td>' + "Center" + '</td>' +
                    '<td>' +
                    '<input id="CheckBanners_DebugLatLng" size="45" type="text" >' +
                    '</td>' +
                '</tr>'+
                '<tr>'+
                    '<td>' + "zoom" + '</td>' +
                    '<td>' +
                    '<input id="CheckBanners_DebugZoom" size="25" type="text" >' +
                    '</td>' +
                '</tr>'+
                '<tr>'+
                    '<td>' + "Bounds NE" + '</td>' +
                    '<td>' +
                    '<input id="CheckBanners_DebugBoundsNE" size="45" type="text" >' +
                    '</td>' +
                '</tr>'+
                '<tr>'+
                    '<td>' + "Bounds SW" + '</td>' +
                    '<td>' +
                    '<input id="CheckBanners_DebugBoundsSW" size="45" type="text" >' +
                    '</td>' +
                '</tr>'+
                '<tr>'+
                    '<td>' + "Size" + '</td>' +
                    '<td>' +
                    '<input id="CheckBanners_DebugSize" size="25" type="text" >'+
                    '</td>' +
                '</tr>'+
*/
                '<tr>'+
                    '<td>' + "JSON format :" + '</td>' +
                    '<td>' +
                    '<input id="CheckBanners_DebugJSON" size="45" type="text" readonly="readonly">'+
                    '</td>' +
                '</tr>'+
            '</table>' ;

    // add result text window - in order to display error
    // add also a show banner path button (the corresponding action will be defined once the banner will be identified
    html +=
    '<div>' +
		'<table>' +
    		'<tr>' +
    		    '<td>' + "<b>detected errors :</b>" + '</td>' +
    		    '<td>' + '<button id ="DrawBannerPath" type="button" disabled>Draw Path</button>'+ '</td>' +
    		'</tr>' +
    		'<tr>' +
    		    '<td> <p id="detected_errors"> none </p> </td>'+
    		'</tr>' +
    	'</table>' +
    '</div>';

    // add banner window (each mission is 50 pixels wide) - the banner table is empty we don't know yet the amount of rows
    html +=
    '<div>' +
        '<table class="bannerTable">'+
		'<tbody id="banner_images">' +
		'</tbody>'
    	'</table>' +
    '</div>';



	dialog({
		html: html,
		id: 'plugin_searchBanner',
		title: 'search Banner',
		width: 'auto'
	});


/*    // disable debug interface
    document.getElementById("CheckBanners_DebugTable").style.display="none";
    document.getElementById("CheckBanners_DebugButton").style.display="none";
    document.getElementById("CheckBanners_StopButton").style.display="none";
*/

    // pressing enter in the search button will also trig the "search" button
    document.getElementById("CheckBanners_SearchString").addEventListener("keyup", function(event) {
         // Cancel the default action, if needed
         event.preventDefault();
        // Number 13 is the "Enter" key on the keyboard
        if (event.keyCode === 13) {
            // Trigger the button element with a click
            document.getElementById("CheckBanners_SearchButton").click();
        }
    });

	console.log("starting searchBanner") ; // used only for debug & breakpoints
}

// button pressed - Go for searching banner
window.plugin.CheckBanners.questionwindowGo = function () {

    var single;
    var regExp;
    var defaultNbMissions;
    var debug_JSON;
    var debug_info;
    var chaine = $('#CheckBanners_SearchString').val();

    // check that the iitc-plugin-missions@jonatkins plugin is loaded, as we depend on this plugin
    if (typeof window.plugin.missions === 'undefined') {
        // the mission standard module has not been loaded, the plug-in will not work
        // warn the user, and give-up
        var html =  '<p><font color="red"><b>This plug-in needs IITC "mission" default plug-in to be activated</b></font></p>' +
                    '<p>Go on <a href=https://iitc.me/desktop/>iitc home page</a> to download and install "Missions" plug-in</p>'
        dialog({
            html: html,
            id: 'plugin_searchBanner_error',
            title: "search Banner-Can't find mission",
            width: 'auto'
        });
        throw "mission plug-in not found";
    }


    // check if the string is a JSON entry, if so then process as debug mode
    try {
        debug_info = JSON.parse(chaine);
    } catch {
        // it is not a JSON entry that was is entered (so it is a nominal search)
        // we do nothing specific, the test will be done later based on debug_JSON existence.
    }

    if (debug_info===undefined) {
        // fill the debug informations
        // for debug, in order to get initial conditions and be able to reproduce
        var bounds = map.getBounds();
        var debug_info = {
                            'Center': map.getCenter(),
                            'Zoom': map.getZoom(),
                            'BoundsNE': bounds.getNorthEast(),
                            'BoundsSW': bounds.getSouthWest(),
                            'MapSize': map.getSize(),
                            'SearchString' : chaine
                         };

    } else {
        // JSON structure provided, so position the browser on the proper position
        // TODO complete with other parameters if needed to reproduce exact situation as described in JSON
        var center = debug_info['Center'];
        var latLng =[ parseFloat(center['lat']) , parseFloat(center['lng'])];
        var zoom =  debug_info['Zoom'];
        map.setView(latLng,zoom);
        chaine = debug_info['SearchString'];
    }

    // we set the toJSON proper fonctionnality to latLng elements
    debug_info['Center'].toJSON = function() {
        return {'lat':this.lat, 'lng':this.lng}
        };
    debug_info['BoundsNE'].toJSON = function() {
        return {'lat':this.lat, 'lng':this.lng}
        };
    debug_info['BoundsSW'].toJSON = function() {
        return {'lat':this.lat, 'lng':this.lng}
        };
    debug_JSON = JSON.stringify(debug_info);

    document.getElementById('CheckBanners_DebugJSON').value = debug_JSON;

    //we delay the launch of the search in order to let reposition the screen on the proper position
    setTimeout(window.plugin.CheckBanners.search(chaine,debug_info),100);
}

var setup = function() {
  $('#toolbox').append('<a onclick="window.plugin.CheckBanners.questionwindow()" title="search for a specific banner validity [s]" accesskey="s">search Banner</a>');

  // style for the dialog boxes TODO check if really usefull, I don't think I'm using any specif class
  $("<style>")
    .prop("type", "text/css")
    .html("#portalslist.mobile {\n  background: transparent;\n  border: 0 none !important;\n  height: 100% !important;\n  width: 100% !important;\n  left: 0 !important;\n  top: 0 !important;\n  position: absolute;\n  overflow: auto;\n}\n\n#portalslist table {\n  margin-top: 5px;\n  border-collapse: collapse;\n  empty-cells: show;\n  width: 100%;\n  clear: both;\n}\n\n#portalslist table td, #portalslist table th {\n  background-color: #1b415e;\n  border-bottom: 1px solid #0b314e;\n  color: white;\n  padding: 3px;\n}\n\n#portalslist table th {\n  text-align: center;\n}\n\n#portalslist table .alignR {\n  text-align: right;\n}\n\n#portalslist table.portals td {\n  white-space: nowrap;\n}\n\n#portalslist table th.sortable {\n  cursor: pointer;\n}\n\n#portalslist table .portalTitle {\n  min-width: 120px !important;\n  max-width: 240px !important;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n#portalslist .sorted {\n  color: #FFCE00;\n}\n\n#portalslist table.filter {\n  table-layout: fixed;\n  cursor: pointer;\n  border-collapse: separate;\n  border-spacing: 1px;\n}\n\n#portalslist table.filter th {\n  text-align: left;\n  padding-left: 0.3em;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n#portalslist table.filter td {\n  text-align: right;\n  padding-right: 0.3em;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n#portalslist .filterNeu {\n  background-color: #666;\n}\n\n#portalslist table tr.res td, #portalslist .filterRes {\n  background-color: #005684;\n}\n\n#portalslist table tr.enl td, #portalslist .filterEnl {\n  background-color: #017f01;\n}\n\n#portalslist table tr.none td {\n  background-color: #000;\n}\n\n#portalslist .disclaimer {\n  margin-top: 10px;\n  font-size: 10px;\n}\n\n#portalslist.mobile table.filter tr {\n  display: block;\n  text-align: center;\n}\n#portalslist.mobile table.filter th, #portalslist.mobile table.filter td {\n  display: inline-block;\n  width: 22%;\n}\n\n")
    .appendTo("head");

  // styles to display the image banners rounded
  $("<style>")
    .prop("type", "text/css")
    .html(".bannerTable td + td {\n padding-left: 0px; \n} .roundedImage > img {\n    width:50px; \n    float:left; } \n .roundedImage {\n    position: relative; \n    overflow:hidden; \n    -webkit-border-radius:50px;\n    -moz-border-radius:50px;\n    border-radius:50px;\n    width:50px;}" )
    .appendTo("head");
  // style to display tooltip on missions
  $("<style>")
    .prop("type", "text/css")
    .html(".roundedImageBubble { \n  display: inline; \n  position: relative; \n } \n .roundedImageBubble .roundedImageBubbleText { \n" +
          "cursor: help; \n  visibility:hidden; \n  top:50%; \n  left: 100%; \n  margin-left:+25px; \n white-space: nowrap; \n  background: white;\n" +
          "color: green; \n  padding: 3px; \n   border: 1px solid green; \n  border-left: 4px solid green;\n  position: absolute; \n  z-index:500;}\n"+
          ".roundedImageBubble:hover .roundedImageBubbleText { \n  visibility: visible; \n }")
    .appendTo("head");

   // add overlay
  $("<style>")
    .prop("type", "text/css")
    .html(".BannerOverlay { \n position: absolute; \n top : 0px; \n right: 0px; \n}")
    .appendTo("head");
  };

// PLUGIN END //////////////////////////////////////////////////////////


setup.info = plugin_info; //add the script info data to the function as a property
if(!window.bootPlugins) window.bootPlugins = [];
window.bootPlugins.push(setup);
// if IITC has already booted, immediately run the 'setup' function
if(window.iitcLoaded && typeof setup === 'function') setup();
} // wrapper end

// inject code into site context
var script = document.createElement('script');
var info = {};
if (typeof GM_info !== 'undefined' && GM_info && GM_info.script) info.script = { version: GM_info.script.version, name: GM_info.script.name, description: GM_info.script.description };
script.appendChild(document.createTextNode('('+ wrapper +')('+JSON.stringify(info)+');'));
(document.body || document.head || document.documentElement).appendChild(script);


